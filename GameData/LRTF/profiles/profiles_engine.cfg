//generic profiles for various engine types.

//Solid Fuel Types
@PART[*]:HAS[#lrtfConfName[Solid],@RESOURCE[SolidFuel]]:NEEDS[LRTFConfig]:BEFORE[zTestFlight]
{
	sF = #$RESOURCE[SolidFuel]/amount$
}
@PART[*]:HAS[#lrtfConfName[Solid],~sF,@MODULE[ModuleB9PartSwitch]/baseVolume]:NEEDS[LRTFConfig]:BEFORE[zTestFlight]
{
	sF = #$MODULE[ModuleB9PartSwitch]/baseVolume$
}
@PART[*]:HAS[#lrtfConfName[Solid],~sF]:NEEDS[LRTFConfig]:BEFORE[zTestFlight]
{
	sF = 60 //default if no other option is available
}
@PART[*]:HAS[#lrtfConfName[Solid],#sF]:NEEDS[LRTFConfig]:BEFORE[zTestFlight]
{	
	//calculate ratedBurnTime
	sT = #$MODULE[ModuleEngines*]/maxThrust$
	@sF /= #$sT$
	@sF *= 15
	@sF += 0.5     //rounds to integer
	@sF ^= :\..*:: //rounds to integer

	LRTFENGINE
	{
		ratedBurnTime = #$../sF$
		cycleReliabilityStart = 0.60
		cycleReliabilityEnd = 0.995

		solidFuelFailures = True
		ignitionFailures = True
		ignitionReliabilityStart = 0.90
		ignitionReliabilityEnd = 0.9995
	}
}

//Turbojet Types
@PART[*]:HAS[#lrtfConfName[Turbojet]]:NEEDS[LRTFConfig]:BEFORE[zTestFlight]
{
    LRTFENGINE
    {
       ratedBurnTime = 18000
       cycleReliabilityStart = 0.20
       cycleReliabilityEnd = 0.999

       maxMach = 3.0
       maxAirTemp = 1800
       turboRamjetFailures = True
    }
}

//Nuclear Types
@PART[*]:HAS[#lrtfConfName[Nuclear]]:NEEDS[LRTFConfig]:BEFORE[zTestFlight]
{
    LRTFENGINE
    {
       ratedBurnTime = 960
       cycleReliabilityStart = 0.35
       cycleReliabilityEnd = 0.999

       reliabilityDataRateMultiplier = 2.0 // 19/83 minutes of flight testing
       explicitDataRate = True

       liquidFuelFailures = True
       ignitionFailures = False
    }
}

//Electric Types
@PART[*]:HAS[#lrtfConfName[Electric]]:NEEDS[LRTFConfig]:BEFORE[zTestFlight]
{
    LRTFENGINE
    {
       ratedBurnTime = 1800
       cycleReliabilityStart = 0.35
       cycleReliabilityEnd = 0.99

       reliabilityDataRateMultiplier = 1.0 // 38/165 minutes of flight testing
       explicitDataRate = True

       electrostaticFailures = True
    }
}

//Monoprop Types
@PART[*]:HAS[#lrtfConfName[Monoprop]]:NEEDS[LRTFConfig]:BEFORE[zTestFlight]
{
    LRTFENGINE
    {
       ratedBurnTime = 180
       cycleReliabilityStart = 0.55
       cycleReliabilityEnd = 0.998

       liquidFuelFailures = True
       ignitionFailures = False         // Monopropellant similar to hydrazine?
    }
}

//LiquidFuel Types
@PART[*]:HAS[#lrtfConfName[Booster]]:NEEDS[LRTFConfig]:BEFORE[zTestFlight]
{
	LRTFENGINE
	{
		ratedBurnTime = 100
		cycleReliabilityStart = 0.45
		cycleReliabilityEnd = 0.99
		
		liquidFuelFailures = True
		ignitionFailures = True
		ignitionReliabilityStart = 0.65
		ignitionReliabilityEnd = 0.995
	}
}
@PART[*]:HAS[#lrtfConfName[Sustainer]]:NEEDS[LRTFConfig]:BEFORE[zTestFlight]
{
	LRTFENGINE
	{
		ratedBurnTime = 140
		cycleReliabilityStart = 0.40
		cycleReliabilityEnd = 0.99
		
		liquidFuelFailures = True
		ignitionFailures = True
		ignitionReliabilityStart = 0.60
		ignitionReliabilityEnd = 0.995
	}
}
@PART[*]:HAS[#lrtfConfName[Vacuum]]:NEEDS[LRTFConfig]:BEFORE[zTestFlight]
{
	LRTFENGINE
	{
		ratedBurnTime = 300
		cycleReliabilityStart = 0.40
		cycleReliabilityEnd = 0.99
		
		liquidFuelFailures = True
		ignitionFailures = True
		ignitionReliabilityStart = 0.60
		ignitionReliabilityEnd = 0.995
	}
}
@PART[*]:HAS[#lrtfConfName[HighEfficiency]]:NEEDS[LRTFConfig]:BEFORE[zTestFlight]
{
	LRTFENGINE
	{
		ratedBurnTime = 160
		cycleReliabilityStart = 0.40
		cycleReliabilityEnd = 0.99
		
		liquidFuelFailures = True
		ignitionFailures = True
		ignitionReliabilityStart = 0.60
		ignitionReliabilityEnd = 0.995
	}
}
@PART[*]:HAS[#lrtfConfName[Maneuvering]]:NEEDS[LRTFConfig]:BEFORE[zTestFlight]
{
	LRTFENGINE
	{
		ratedBurnTime = 340
		cycleReliabilityStart = 0.40
		cycleReliabilityEnd = 0.99
		
		liquidFuelFailures = True
		ignitionFailures = True
		ignitionReliabilityStart = 0.60
		ignitionReliabilityEnd = 0.995
	}
}

//creates a config name using the part name
@PART[*]:HAS[@LRTFENGINE,#lrtfConfName]:NEEDS[LRTFConfig]:BEFORE[zTestFlight]
{
	@LRTFENGINE
	{
		name = #$../name$
		@name ^= :_:-:
	}
}